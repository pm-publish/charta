{{ set(this, 'title', _Blog.getBlogTitle()) }}

{% cache 'indexCache_1' 300 %}


{% set networkData  = _Network.getNetworkData() %}
{% set layoutTitle  = _Page.getLayoutTitle() | lower | replace({' ': '_'}) %}
{% set blogData     = _Blog.getBlog() %}
{% set homeBlog     = blogData['title'] | lower %}
{% set config       = _Network.getThemeConfig() %}
{% set layout       = blogData.layout %}
{% set dev          = _AppHelper.getApplicationEnv() == 'DEV' ? false : false %}

{% set bannerSpots  = [3,5] %}
{% set blogFeeds    = {} %}
{% set panels       = [] %}
{% set breaking = {} %}


{% set themeColor = "#4A90E2" %}
{% if networkData['styling']['colours']['primaryColor'] is defined %}
    {% set themeColor = networkData['styling']['colours']['primaryColor'] %}
{% endif %}


{# *******************************************************
            CONFIG OPTIONS SET IN PLATFORM
******************************************************* #}

{% if config['active'] is not defined or config['active'] == true %}

    {% if config['page']['index']['sections'] is defined %}

        {% set panels = config['page']['index']['sections'] %}

        {% set sectionOrder = panels | keys %}

        {% set blogFeeds = {} %}

        {% for i, panel in panels %}

            {% if panel['articleOrder'] is defined %}

                {# If a panel has multiple blogs we get the count of items to fetch from iterating
                over the articleOrder array #}
                {% for blogName in panel['articleOrder'] %}

                    {% if blogFeeds[blogName] is not defined %}
                        {% set blogFeeds = blogFeeds | merge({ (blogName): { "limit" : 1} }) %}
                    {% else %}

                        {% set count = blogFeeds[blogName].limit %}

                        {% set blogFeeds = blogFeeds | merge({ (blogName): { "limit" : count + 1} }) %}
                    {% endif %}
                {% endfor %}



            {# If a panel has a single blog we get the count of items to fetch from checking the articleCount key #}
            {% else %}

                {% set blogName = panel['blog'] %}

                {% if panel['articleCount'] is defined %}

                    {% set count = panel['articleCount'] %}
                    
                    {% if blogFeeds[blogName] is not defined or blogFeeds[blogName].limit < count %}
                        {% set blogFeeds = blogFeeds | merge({ (blogName): { "limit" : count} }) %}
                    {% endif %}

                {% endif %}
            {% endif %}

        {% endfor %}
        
    {% endif %}



    {% if layoutTitle == 'index_breaking_news' %}
        {% if config['page']['index']['breaking-news'] is defined %}
            {% set breaking = config['page']['index']['breaking-news'] %}
            {% set blogFeeds = blogFeeds | merge({
                (breaking.section) : { 
                    "limit" : breaking.limit
                    } 
                }) %}
        {% endif %}
    {% endif %}

    {% if config['inventory'][homeBlog]['bannerSpots'] is defined %}
        {% set bannerSpots = config['inventory'][homeBlog]['bannerSpots'] %}
    {% endif %}

{% endif %}




{# <div class="clearfix"></div> #}


<main id="main" class="site-main" role="main" data-layout="{{layoutTitle}}">


<div class="cta-wrapper">
    <div class="cta-info">
        <div class="cta-info__icon">
            <svg width="725" height="501" viewBox="0 0 725 501" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M-215.553 409.136C1.01713 440.31 -151.754 485.182 220.045 593.934C591.844 702.688 821.13 475.717 684.883 217.536C548.636 -40.6441 573.593 -392.399 288.288 -466.833C2.98261 -541.266 -430.935 378.089 -215.553 409.136Z" fill="{{themeColor}}" />
            </svg>
        </div>
        <div class="cta-info__content">
            <h2>Lorem ipsum oane aiorl bauess teiar</h2>
            <p>Proin tempor ligula at sodales tempor. Praesent lobortis, ligula ac ultricies lobortis, mauris purus tempus ante, ac varius diam dolor eu elit. </p>
            <a href="javascript:;">CTA</a>
        </div>
    </div>
    <div class="cta-image" style="background-image: url('{{networkData.templatePath}}/static/images/cta_image.png')"></div>
</div>
<div class="cta-wrapper cta-d2"></div>

</main><!-- .site-main -->




{% endcache %}
